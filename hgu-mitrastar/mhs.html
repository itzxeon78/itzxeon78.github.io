<!DOCTYPE html>
<html>
<head>
	<meta charset="utf-8">
	<meta http-equiv="Content-Type" content="text/html">
	<meta http-equiv="x-frame-options" content="sameorigin">
	<meta name="viewport" content="width=device-width; initial-scale=1.0">
	<title>movistar</title>
	<link href="mhs/css/style.css" rel="stylesheet" type="text/css">
	<link type="text/css" rel="stylesheet" href="mhs/css/ui.switchbutton.min.css">
	<script src="mhs/js/jquery-1.6.3.min.js"></script>
	<script src="mhs/js/jquery.tmpl.min.js"></script>
	<script src="mhs/js/jquery-ui-1.8.16.custom.min.js"></script>
	<script src="mhs/js/jquery.switchbutton.min.js"></script>
	<script src="mhs/js/main.js"></script>
	<script src="mhs/js/jquery.utils.homestation.min.js"></script>
	<script src="mhs/js/networkMap/wifi.js"></script>
	<script src="mhs/js/jquery.qrcode.min.js"></script>
	<script>
		function MM_swapImgRestore() {
			var i,x,a=document.MM_sr; for(i=0;a&&i<a.length&&(x=a[i])&&x.oSrc;i++) x.src=x.oSrc;
		}
		function MM_preloadImages() {
			var d=document; if(d.images){ if(!d.MM_p) d.MM_p=new Array();
				var i,j=d.MM_p.length,a=MM_preloadImages.arguments; for(i=0; i<a.length; i++)
				if (a[i].indexOf("#")!=0){ d.MM_p[j]=new Image; d.MM_p[j++].src=a[i];}}
			}
			function wifiHideClick() {
				var isDisable = document.getElementById("wifi_visible1").checked;
				if(isDisable)
					alert('Al ocultar el SSID, la funcionalidad WPS quedará desactivada en tu router.');
				else
					alert('Al hacer visible el SSID, la funcionalidad WPS quedará activada en tu router.');
				return;
			}
			function getSsidName(){
				var tmp="MOVISTAR_0000";
				document.getElementById("ssidname").value = tmp;
				var tmp1="";
			}
			function MM_findObj(n, d) {
				var p,i,x;  if(!d) d=document; if((p=n.indexOf("?"))>0&&parent.frames.length) {
					d=parent.frames[n.substring(p+1)].document; n=n.substring(0,p);}
					if(!(x=d[n])&&d.all) x=d.all[n]; for (i=0;!x&&i<d.forms.length;i++) x=d.forms[i][n];
					for(i=0;!x&&d.layers&&i<d.layers.length;i++) x=MM_findObj(n,d.layers[i].document);
						if(!x && d.getElementById) x=d.getElementById(n); return x;
				}
				function MM_swapImage() {
					var i,j=0,x,a=MM_swapImage.arguments; document.MM_sr=new Array; for(i=0;i<(a.length-2);i+=3)
					if ((x=MM_findObj(a[i]))!=null){document.MM_sr[j++]=x; if(!x.oSrc) x.oSrc=x.src; x.src=a[i+2];}
				}
			</script>
		</head>
		<body onload="MM_preloadImages('mhs/img/x3.png'); getSsidName();">
			<div class="wrapper">
				<div class="wrapper2">
					<div id="pageloading" style="display: none" >
						<div id="loadingimg"><img src="mhs/images/loading.gif" width="102" height="116" ></div>
					</div>
					<div class="topBorder">
						<div class="top_LLBox"><div id="home"><img src="mhs/img/meun.png" width="45" height="45" ></div><div id="menu" class="toptitle2">MEN&Uacute</div>
						<div id="pagemenu" class="menuList">
							<ul>
								<li><a href="mhs.html">WiFi</a></li>
								<li><a href="wifi5g.html">WiFi Plus</a></li>
								<li><a href="wifisecond.html">WiFi Invitados</a></li>
								<li><a href="PortForwardWizard.html?page=1">Puertos</a></li>
								<li class="sec"><a href="#">Red local&nbsp;></a>
									<ul>
										<li><a href="networkmap.html">Mapa de red local</a></li>
										<li><a href="lan_v4.html">Red Local</a></li>
									</ul>
								</li>
								<li><a href="multipuesto.html">Multipuesto / Monopuesto</a></li>
								<li><a href="lan_v6.html">IPv6</a></li>
								<li><a href="changepasswd.html">Cambio contrase&ntildea del router</a></li>
								<li><a href="firmwareupgrad.html">Actualizaciones Firmware</a></li>
								<li><a href="configsetting.html">Otras funcionalidades</a></li>
								<li class="sec"><a href="#">Ayuda&nbsp;></a>
									<ul>
										<li><a href="wizard_help.html">Ayuda configurador web</a></li>
										<li><a href="sysinfo.html">Acerca de</a></li>
									</ul>
								</li>
								<li><a href="advancedsettings.html">Configuraci&oacuten avanzada</a></li>
							</ul></div>
						</div>
						<div class="top_CBox toptitle">Acceso al Configurador Router</div>
						<div class="top_RRBox logoBox_in"><img src="mhs/img/logo.png"></div>
					</div>
					<div class="topBorder2">
						<div class="toptitle2">Acceso al Configurador Router</div>
					</div>
					<div class="mainBorder"><div class="items"><a href="javascript:void(0)" onclick="logoutBtu();">Cerrar sesi&oacuten</a></div></div>
					<div class="locationTitle">WiFi</div>
					<div class="mainBorder">
						<div id="logout" class="finBox">
							<div class="artBox">¿Est&aacute seguro de que desea cerrar la sesi&oacuten?<br>
							</div>
							<div class="artBox">
								<div class="leftBtu"><input type="button" name="button" id="button" value="Cancelar" class="checkBtu" onclick="closeDiv();"></div>
								<div class="rightBtu"><input type="button" name="button" id="button" value="Aceptar" class="checkBtu" onclick="javascript:location.href='logout.cmd'"></div>
							</div>
						</div>
						<div class="artBox black2">Desde aqu&iacute podr&aacutes configurar tu red inal&aacutembrica. Escaneando el c&oacutedigo QR puedes incluso conectar tus equipos directamente. Tambi&eacuten puedes a&ntildeadir las direcciones MAC de los equipos que puedan acceder a tu Wifi.</div>
						<div class="artBox">
							<div class="tabBorder">
								<div class="tabID">Nombre Wifi</div><div class="tabInput2"><input name="ssidname" type="text" class="chooseBox" id="ssidname" onkeypress="return maxlength32(event)"></div>
							</div>
							<div class="tabBorder">
								<div class="tabID">Ocultar nombre Wifi</div><div class="tabInput">
									<input type="radio" name="wifi_visible" id="wifi_visible1" onclick="wifiHideClick();" value="1">
									<label for="radio"></label>
									S&iacute&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
									<input type="radio" name="wifi_visible" id="wifi_visible2" onclick="wifiHideClick();" value="0">
								No            </div>
							</div>      
							<div class="tabBorder" id="wifi_pass">
								<div class="tabID">Clave Wifi <br>(Introduce letras, números y caracteres especiales (@,&,!,+, etc) para que tu clave wifi tenga seguridad alta)</div><div class="tabInput2"><input name="wifiPass" type="password" autocomplete="new-password" maxlength="63" class="chooseBox" id="wifiPass" onkeyup="securitylevel(2);" onblur="securitymode(this);" >
								</div>
								<div class="tabcontrol2"><img src="mhs/img/icon_eye.png" name="reveal" onclick="revealPasswd();"></div>
							</div>
							<div class="tabBorder_nM">
								<div class="tabID2">Nivel de seguridad de la contrase&ntildea</div><div class="tabInput2"><div class="wrmBox"><span id="pass_level_value" class="trad" key="Insegura"></span><div id="id_pro_inner"></div></div></div>
							</div>
							<div class="tabBorder">
								<div class="tabID">Estado Red Inal&aacutembrica</div><div class="tabInput">
									<input type="radio" name="wifi_status" id="wifi_status1" value="1">
									<label for="radio"></label>
									Activado&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
									<input type="radio" name="wifi_status" id="wifi_status2" value="0">
								Desactivado            </div>
							</div>
						</div>
						<div class="artBox">
							<div class="u15">
								<span class="sub">Aviso:</span> Los m&eacutetodos de cifrado WPA o WEP no son compatibles con WPS (2.0). Si seleccionas alguno de ellos la funcionalidad WPS quedar&aacute desactivada en tu router.
							</div>
						</div>
						<div id="wps_disable" class="finBox" >
							<div class="artBox">Recuerda que puedes introducir 13 caracteres en codificación ASCII (letras, números y caracteres especiales)  o bien 26 caracteres en codificacion Hexadecimal (0-9 y A-F)<br>
								Con el cifrado WEP la funcionalidad WPS quedará desativada en tu router<br>
							</div>
							<div class="artBox">
								<div class="rightBtu"><input type="button" name="button" id="button" value="Aceptar" class="checkBtu" onclick="closeDiv();"></div>
							</div>
						</div>
						<div id="wep_errorPW" class="finBox" >
							<div class="artBox">La clave WEP no debe estar vacia. La clave debe tener ya sea 13 o 26 caracteres.<br>
							</div>
							<div class="artBox">
								<div class="rightBtu"><input type="button" name="button" id="button" value="Aceptar" class="checkBtu" onclick="closeDiv();"></div>
							</div>
						</div>
						<div class="artBox">
							<div class="tabBorder_46"><div class="tabID">Tipo de cifrado</div><div class="tabInput">
								<select id="wifi_sec" onchange="wifisecuritymodified(this);" >
									<option value="None" class="trad" key="Sin seguridad"></option>			
									<option value="WPA2PSK" class="trad" key="WPA2-PSK"></option>
									<option value="WPAPSKWPA2PSK" class="trad" key="WPA/WPA2 PSK mixed" ></option>
									<option value="WEP-128Bits" class="trad" key="Bajo (WEP-128Bits)"></option>
								</select>
							</div></div>
							<div class="tabBorder_46" style="display:none" id="wifi_TKIPAES"><div class="tabID">Encriptaci&oacuten</div><div class="tabInput">
								<select name="TKIP_Selection" class="wselect2" id="TKIP_Selection">
									<option value="AES">AES</option>
									<option value="TKIPAES">TKIP+AES</option>
								</select>
							</div></div>
							<div class="tabBorder_46"><div class="tabID">N&uacutemero canal WiFi</div><div class="tabInput">
								<select name="select5" class="wselect2" id="select_numcanal">
								</select>
							</div></div>
							<div class="tabBorder_46"><div class="tabID">Canal actual:</div><div class="tabInput black2" id="cur_wifi_channel"></div></div>
							<input type="hidden" name="sessionKey" id="sessionKey" value="123456789">           
							<div class="tabBorder_70">
								Escanea este c&oacutedigo y guarda los datos de tu configuraci&oacuten inal&aacutembrica en tu m&oacutevil. Adem&aacutes, si tu aplicaci&oacuten de escaneo lo permite, podr&aacutes compartirlo con tus amigos e incluso conectarte directamente 
							</div>
							<div class="tabBorder_20" id="qrcode"></div>
						</div>
						<div class="locationTitle">WPS</div> 
						<div class="artBox">Para habilitar la ventana WPS pulsa el bot&oacuten f&iacutesico de tu equipo dedicado a esta funcionalidad.<br>
							<span class="sub">Aviso:</span> El m&eacutetodo de cifrado WPA no es compatible con WPS 2.0. Para m&aacutes informaci&oacuten consulta la opci&oacuten de <span class="sub"><a href="wizard_help.html#wps">Ayuda</a></span>.</div>
							<div class="locationTitle">Filtrado MAC</div>
							<div class="artBox_nM">Listado de <span class="sub">direcciones MAC</span> de los equipos que pueden acceder a tu Wifi:</div>
							<div class="tabBorder" id="ruleActive">
								<div class="tabcontrol">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; Activar &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<input type="checkbox" class="common" id="mainSwitch"></div>
							</div>
							<div class="artBox" id="rules_list">
								<div id="list_body">
									<div class="tabBorder" id="ruleN" style="display: none">
										<div class="del_icon" id="minus_icon"><a href="#" onmouseout="MM_swapImgRestore()" onmouseover="MM_swapImage('Image3','','mhs/img/x3.png',1)"><img src="mhs/img/x2.png" width="23" height="23" id="Image3" ></a></div>
										<div class="tabInput3"><input name="ruleMACFilterN" type="text" class="chooseBox_H30" id="ruleMACFilterN" value="changeMe"></div>
									</div>	 
								</div>	
							</div>
							<div class="tabBorder">
								<div class="tabcontrol3"> <span class="blueLinkRight" id="Reset_ID"><a href="javascript:void(0)">Eliminar todos</a></span></div>
							</div>
							<div class="markBg">
								<div class="artBox_nM">
									<div class="tabBorder"><div class="tabID_10 font_H32">Direcci&oacuten MAC</div>
									<div class="tabInput2"><input type="text" name="macRule" id="macRule" class="chooseBox"></div>
									<div class="tabcontrol2"><input type="submit" name="plus_icon" id="plus_icon" value="Añadir" class="checkBtu"></div>
								</div></div>
							</div>
							<div class="tabBorder"><input type="submit" name="accept_icon" id="accept_icon" value="Aplicar Cambios" class="checkBtu" onclick="wifiaccept();" ></div>
							<div id="fin" class="fin_item">
								<ul>
									<li id="calltab1"><a class="finBox" id="alink" href="#tab1">alink</a></li>
									<li id="calltab2"><a class="finBox" id="alink2" href="#tab2">alink2</a></li>
								</ul>
							</div>
							<div id="tab1" class="finBox">
								<div class="artBox" id="content" align="center">content<br>
								</div>
								<div class="artBox">
									<div align="center"><input  name="button" id="button" value="Cerrar" style="text-align:center" class="checkBtu2" onclick="closeDiv();"></div>
								</div>
							</div>
							<div id="tab2" class="finBox">
								<div class="artBox" id="content2" align="center">content<br>
								</div>
								<div class="artBox">
									<div align="center"><input  name="button" id="button" value="Cerrar" style="text-align:center" class="checkBtu2" onclick="closeDiv2();"></div>
								</div>
							</div>
						</div>
						<div class="footerBorder">
							© Telef&oacutenica de Espa&ntildea S.A.U. Todos los derechos reservados v 1.1
						</div>
					</div></div>
				</body>
				<script>
					var haveWlan_MAC = 0;
					var loadMacWlanIndex = -1;
					var global_rulenum = 0 ;
					var securitypassWEP="1234567890123";
					var securitypassWPA2="Password123";
					var macfltMax = 28;
					var sub = document.getElementById("alink");
					var sub2 = document.getElementById("alink2");
					var ren;
					if(detectAgent()=="MSIE") {
						ren = "table";
					}else {
						ren = "canvas";
					}
					$(document).ready(function() {
						$.fx.speeds._default = 500;
						jQuery.getJSON('mhs/config.json', function(data, textStatus){
							CONFIG = data.CONFIG;
							configurationLoaded();
						});
						$("#ruleActive").find("input[id=mainSwitch]").switchbutton();
						var WLan_MAC =[["",""],
						["",""],
						["",""],
						["",""],
						["",""],
						["",""],
						["",""],
						["",""],
						["",""],
						["",""],
						["",""],
						["",""],
						["",""],
						["",""],
						["",""],
						["",""],
						["",""],
						["",""],
						["",""],
						["",""],
						["",""],
						["",""],
						["",""],
						["",""],
						["",""],
						["",""],
						["",""],
						["",""],
						["",""],
						["",""],
						["",""],
						["",""]
						];
						for (var i=0;i<(WLan_MAC.length);i++){
							if(WLan_MAC[i][0].length!=0){
								haveWlan_MAC = 1;
								loadMacWlanIndex = i;
								loadCreateMacRuleForm(1);
							}
						}
						function loadCreateMacRuleForm(flag){
							var allInputs = $("#rules_list #list_body :text");
							var i = 0;
							var test;
							if(flag==0){
								if(global_rulenum >=macfltMax){
									alert("El número máximo de direcciones es " + macfltMax);
									return;
								}else{
									test=$("#macRule").attr("value");
								}
							}
							for(i=0;i<allInputs.length;i++){
								if(allInputs.eq(i).val() == test){
									alert("Tiene la misma dirección MAC");
									return;
								}
							}
							if(loadMacWlanIndex > -1 && loadMacWlanIndex < macfltMax){
								test=WLan_MAC[loadMacWlanIndex][0];
								loadMacWlanIndex = -1;
							}
							var id = global_rulenum++;
							var newRule = $("#ruleN").clone();
							newRule.show();
							newRule.attr("id", "rule"+id);
							if(loadMacWlanIndex == -1 && test != "undefined"){
								newRule.find("input[value=changeMe]").attr("value", test);			
								newRule.find("input[id=ruleMACFilterN]").attr("id", "ruleMACFilter"+ id);
							}else{
								newRule.hide();
							}
							newRule.find("#minus_icon").bind("click", function(){
								var thisrule = $(this).parents("#rules_list #list_body .tabBorder ");
								newdeleteRule(thisrule);  	
								global_rulenum--;
							});
							$("#rules_list #list_body:first").append(newRule);				
						}
						function clearnAllMac(){
							$("#rules_list").remove();
						}
						$('input[type="checkbox"]').change(function(){
							if($("#mainSwitch").attr("checked"))
							{
								$('input[name="ruleMACFilterN"]').css({'background-color' : '#FFFFFF'});
							}else{
								$('input[name="ruleMACFilterN"]').css({'background-color' : '#E3E3E3'});
							}
						});
						$('#plus_icon').click(function() {
							if(doMACcheck(document.getElementById("macRule"))){
								loadCreateMacRuleForm(0);	
								document.getElementById("macRule").value = "";
							}
						});
						$('#plus').click(function() {
							loadNewApplication(); 
						});
						$('#Reset_ID').click(function() {
							clearnAllMac();
							global_rulenum = 0 ;
						});
						$("#id_pro_inner").css("background-position","0 " + (0*-10) + "px");
						var CountryRegion = "1";
						if ( CountryRegion == 0 ){
							count = 11;
						}else if ( CountryRegion == 2 ){
							count = 14;
						}else{
							count = 13;
						}
						var options = "";		
						options += '<option value= 0 > Auto </option>';
						for(i=0;i<count;i++)
						{
							options += '<option class="trad" value=' +	(i+1) + '>'+_("Canal")+' '+(i+1)+'</option>';
						}
						$("#select_numcanal").html(options);
						var Channel = '1';
						document.getElementById("select_numcanal").selectedIndex = Channel;
						if(Channel == 0){
							var CurrentChannel="1";
							$("#cur_wifi_channel").text(CurrentChannel);
						}else{
							$("#cur_wifi_channel").text(Channel);
						}
						frmLoad();		
						var sec_mode=document.getElementById("wifi_sec").selectedIndex;		
						if(sec_mode==0){
							$("#wifi_pass").hide();
						}
						else if( sec_mode == 1 || sec_mode == 2){
							securitypassWPA2=document.getElementById("wifiPass").value="Password123";
							$("#wifi_TKIPAES").show();
						}else if( sec_mode == 3 ){
							securitypassWEP=document.getElementById("wifiPass").value="1234567890123";		
						}
						securitylevel(1);
						generateQRCode();
					});
function switch_action (rule){
	var action= rule.find("#switch_icon").text();
	if( action == "Habilitar"){		
		rule.find("#switch_icon").text("Deshabilitar");
	}else {			
		rule.find("#switch_icon").text("Habilitar");
	}
}
function revealPasswd()
{
	var oldObject = document.getElementById("wifiPass");
	var newObject = document.createElement('input');
	newObject.value = $("#wifiPass").attr("value");
	newObject.name = oldObject.name;
	newObject.id = oldObject.id;
	newObject.className = oldObject.className;
	newObject.setAttribute("maxlength", 63); 
	newObject.onkeyup = function(){securitylevel(2);};
	newObject.onblur = function(){securitymode(this);}; 
	if(oldObject.type == "password")
	{
		newObject.type = "text";
	}
	else
	{
		newObject.type = "password";
		newObject.autocomplete = "new-password";
	}
	oldObject.parentNode.replaceChild(newObject,oldObject);
	return newObject;
}
function isHexaDigit(digit) {
	var hexVals = new Array("0", "1", "2", "3", "4", "5", "6", "7", "8", "9",
		"A", "B", "C", "D", "E", "F", "a", "b", "c", "d", "e", "f");
	var len = hexVals.length;
	var i = 0;
	var ret = false;
	for ( i = 0; i < len; i++ )
		if ( digit == hexVals[i] ) break;
	if ( i < len )
		ret = true;
	return ret;
}
function isValidKey(val, size) {
	var ret = false;
	var len = val.length;
	var dbSize = size * 2;
	if ( len == size )
		ret = true;
	else if ( len == dbSize ) {
		for ( i = 0; i < dbSize; i++ )
			if ( isHexaDigit(val.charAt(i)) == false )
				break;
			if ( i == dbSize )
				ret = true;
		} else
		ret = false;
		return ret;
	}
	function isValidHex(value)
	{
		var ret = true;
		if((value.length % 2) != 0)
		{
			ret = false;
		}
		if(value.match(/[^a-fA-F0-9]+/))
		{
			ret = false;	
		}
		return ret;
	}
	function checkHexDigitLevel(value)
	{
		var flagNumber = 0;
		var flagLetter = 0;
		var flagSymbol = 0;
		var hexDigits = value.length / 2;
		var level = 0;
		var i = 0;
		while (level < 3 && i < hexDigits)
		{
			var asciiCode = parseInt(value.substring(i*2,i*2+2),16);
			if (asciiCode >= 48 && asciiCode <= 57)
				{ flagNumber = 1; }
			else if (asciiCode >= 65 && asciiCode <= 90)
				{ flagLetter = 1; }
			else if (asciiCode >= 97 && asciiCode <= 122)
				{ flagLetter = 1; }
			else if (asciiCode >= 0 && asciiCode <= 128)
				{ flagSymbol = 1; }
			level = flagNumber + flagLetter + flagSymbol;
			i++;
		}
		return level;
	}
	function updateWEPstrength(type){
		var value;
		var level = 0;
		if(type == 1){
			value = "1234567890123";
		}else if(type == 2){
			value = $("#wifiPass").attr("value");
		}
		var n = 0;
		if (value != null) 
			n = value.length;
		if (n < 0) 
			n = 0;
		var L = 1;
		if(value.match(/([0-9])+/)){
			level++; 
		}
		if(value.match(/([a-zA-Z])+/)){
			level++;
		}
		if(value.match(/[^a-zA-Z0-9]+/)){
			level++;
		}
		if (n < 13){
			L = 1;
		}else if( n >= 13 && n < 26){
			if(level == 1)
				{L = 1;}
			else if(level >= 2)
				{L = 3;}
		}else if (n >= 26){	
			if(isValidHex(value)){
				level = checkHexDigitLevel(value);
			}
			if(level == 1)
				{L = 1;}
			else if(level >= 2)
				{L = 3;}
		}
		$("#pass_level_value").css("margin-left", (L *28) + "px");
		switch(L){
			case 1:
			$("#pass_level_value").attr("key", "Baja");
			break;
			case 3:
			$("#pass_level_value").attr("key", "Media");
			break;
			case 5:
			$("#pass_level_value").attr("key", "Excelente");
			break;
		}
		reloadTexts();
	}
	function updateWPAPSKstrength(type){
		var value;
		var level = 0;
		if(type == 1){
			value = "Password123";
		}else if(type == 2){
			value = $("#wifiPass").attr("value");
		}
		var n = 0;
		if (value != null) 
			n = value.length;
		if (n < 0) 
			n = 0;
		var L = 1;
		if(value.match(/([0-9])+/)){
			level++; 
		}
		if(value.match(/([a-zA-Z])+/)){
			level++;
		}
		if(value.match(/[^a-zA-Z0-9]+/)){
			level++;
		}
		if (n < 8){
			L = 1;
		}else if(n >=8 && n <= 10){
			if(level == 1)
				{L = 1;}
			else if(level > 1)
				{L = 3;}
		}else if(n > 10 && n <= 63){
			if(level == 1)
				{L = 1;}
			else if(level == 2)
				{L = 3;}
			else if(level == 3)
				{L = 5;}
		}else if (n >= 64){	
			if(isValidHex(value))
			{
				level = checkHexDigitLevel(value);
			}
			if(level == 1)
				{L = 1;}
			else if(level == 2)
				{L = 3;}
			else if(level == 3)
				{L = 5;}
		}
		$("#pass_level_value").css("margin-left", (L *28) + "px");
		switch(L){
			case 1:
			$("#pass_level_value").attr("key", "Baja");
			break;
			case 3:
			$("#pass_level_value").attr("key", "Media");
			break;
			case 5:
			$("#pass_level_value").attr("key", "Excelente");
			break;
		}
		reloadTexts();
	}
	function updateWEP64strength(object)
	{
		var index = object.value.indexOf("0x");
		len=object.value.length;
		if(len == 0){
			alert("La clave WEP no debe estar vacia");
			return false;
		}
		if(object.value.indexOf(" ")!=-1){
			alert("Spaces and underscores are not allowed.");
			return false; 
		}
		if(object.value.indexOf("_")!=-1){
			alert("Spaces and underscores are not allowed.");
			return false; 
		}
		if(len==5 || len==10){
			if ( isValidKey(object.value, 5) == false ) {
				alert("Invalid Key Value");
				return false;
			}
		}
		else
		{
			alert("Invalid Key Value");
			return false;
		}
		return true;
	}
	function updateWEP128strength(object){
		var index = object.value.indexOf("0x");
		len=object.value.length;
		if(len == 0){
			alert("La clave WEP no debe estar vacia. La clave debe tener ya sea 13 o 26 caracteres.");
			return false;
		}
		if(object.value.indexOf("_")!=-1){
			alert("Los espacios y guiones bajos , no se permiten.");
			return false; 
		}
		if(len==13 || len==26){
			if ( isValidKey(object.value, 13) == false ) {
				alert("Valor no válido de clave.");
				return false;
			}
		}
		else
		{
			alert("Valor no válido de clave.");
			return false;
		}
		return true;
	}
	function maxlength32(e){
		var len = 0, charlen = 0;
		var keynum = 0;
		var keychar;
		var x = document.getElementById("ssidname");
		if(x.value.length > 0)
		{
			len = UTF8CodeLength(x.value);
			if(window.event)
			{
				keynum = e.keyCode;
			}
			else if(e.which)
			{
				keynum = e.which;
			}
			if(keynum >= 32)
			{
				keychar = String.fromCharCode(keynum);
				charlen = UTF8CodeLength(keychar);
				if(len+charlen > 32)
				{
					return false;
				}
			}
		}
		return true;
	}
	function securitymode(b){
		var wifisec_mode=document.getElementById("wifi_sec").selectedIndex;		
		if(wifisec_mode == 1 || wifisec_mode == 2){
			updateWPAstrength(0);
		}else if(wifisec_mode == 3){
			updateWEP128strength(b);
		}	
	}
	function securitylevel(b){
		var wifisec_mode=document.getElementById("wifi_sec").selectedIndex;		
		if(wifisec_mode == 1 || wifisec_mode == 2){
			updateWPAPSKstrength(b);
		}else if(wifisec_mode == 3){
			updateWEPstrength(b);
		}
	}
	function wifisecuritymodified(select){
		var wep="1234567890123";
		if($("#wifi_sec")[0].options[1].selected == true || $("#wifi_sec")[0].options[2].selected == true){     
			securitypassWPA2=document.getElementById("wifiPass").value="Password123";		
			updateWPAPSKstrength(1);
		}else if( $("#wifi_sec")[0].options[3].selected == true ){
			if(wep == "1234567890123")
				securitypassWEP=document.getElementById("wifiPass").value="";
			else
				securitypassWEP=document.getElementById("wifiPass").value=wep;
			updateWEPstrength(1);
		}
		if ($("#wifi_sec")[0].options[0].selected == true) {
			securitySelected = "None";
			$("#wifi_pass").hide(500);
			$("#wifi_wpa").hide();
			$("#wifi_TKIPAES").hide();
			$("#pass_level_value").css("margin-left", "0px");
			$("#pass_level_value").attr("key", "Baja");	
			reloadTexts();
		}
		if ($("#wifi_sec")[0].options[1].selected == true || $("#wifi_sec")[0].options[2].selected == true) {
			$("#wifi_pass").show();
			$("#wifi_wpa").hide(500);
			$("#wifi_TKIPAES").show();
		}
		if ($("#wifi_sec")[0].options[3].selected == true ) {
			$("#wps_disable").fadeIn();
			$("#wifi_pass").show();
			$("#wifi_wpa").hide(500);
			$("#wifi_TKIPAES").hide();
		}
		$('#wifiPass').unbind("keypress");
		$('#wifiPass').unbind("keydown");
		$('#wifiPass').unbind("keyup");
	}
	function doMACcheck(object)
	{
		var szAddr = object.value;
		var len = szAddr.length;
		if ( len == 0 )
			return 0;
		if ( len == 12 )
		{
			var newAddr = "";
			var i = 0;
			for ( i = 0; i < len; i++ )
			{
				var c = szAddr.charAt(i);
				if ( doHexCheck(c) < 0 )
				{
					alert(_("WIFI_MAC_ADD_ERROR"));
					object.value ="00:00:00:00:00:00";
					object.focus();
					return 0;
				}
				if ( (i == 2) || (i == 4) || (i == 6) || (i == 8) || (i == 10) )
					newAddr = newAddr + ":";
				newAddr = newAddr + c;
			}
			object.value = newAddr;
			return 1;
		}
		else if ( len == 17 )
		{
			var i = 2;
			var c0 = szAddr.charAt(0);
			var c1 = szAddr.charAt(1);
			if ( (doHexCheck(c0) < 0) || (doHexCheck(c1) < 0) )
			{
				alert(_("WIFI_MAC_ADD_ERROR"));
				object.value ="00:00:00:00:00:00";	
				object.focus();
				return 0;
			}
			i = 2;
			while ( i < len )
			{
				var c0 = szAddr.charAt(i);
				var c1 = szAddr.charAt(i+1);
				var c2 = szAddr.charAt(i+2);  
				if ( (c0 != ":") || (doHexCheck(c1) < 0) || (doHexCheck(c2) < 0) )
				{
					alert(_("WIFI_MAC_ADD_ERROR"));
					object.value ="00:00:00:00:00:00";	
					object.focus();
					return 0;
				}
				i = i + 3;
			}
			return 1; 
		}
		else
		{
			alert(_("WIFI_MAC_ADD_ERROR"));
			object.value ="00:00:00:00:00:00";	
			object.focus();
			return 0;
		}
	}
	function loadingProcess(){	
		$("#pageloading").css("display","block");
		setTimeout("location.href = 'mhs.html';",10000);
		$("#pageloading").fadeOut(10000);
	}
	function generateQRCode () {
		var ssid = "MOVISTAR_0000";
		var org_enc = "psk2";	
		if((org_enc.indexOf("psk")!=-1) || (org_enc.indexOf("wpa")!=-1)){
			var enc = "WPA";
			var key = "Password123";
		}else if(org_enc.indexOf("shared")!=-1){
			var enc = "WEP";
			var key = "1234567890123";
		}else{
			if(document.getElementById("wifi_sec").selectedIndex == 3){
				var enc = "WEP";
				var key = "1234567890123";
			}
			else
			{
				var enc="nopass";
				var key="";
			}
		}
		var qrstring = 'WIFI:S:'+ssid+';T:'+enc+';P:'+key+';';
		qrstring += ';';
		$('#qrcode').empty();
		$('#qrcode').qrcode({
			render	: ren,
			text	: qrstring,
			padding : 0,
			width: 96,
			height: 96
		});
	}
	function frmLoad(){
		var mode = 'psk2';
		var wpaPskKey = 'Password123';
		var wpa = 'aes';
		var hide = '0';
		var wanip = '0.0.0.0';
		var enbl = '1';
		var fltmac = 'disabled';
		var wep = 'disabled';
		switch(mode){
			case "open":
			if(wep == 'enabled')
			{
				$('#wifi_sec').val("WEP-128Bits");
			}
			else
			{
				$('#wifi_sec').val("None");
				$("#wifi_pass").hide();
				$("#wifi_TKIPAES").hide();
			}
			break;
			case "shared":
			$('#wifi_sec').val("WEP-128Bits");
			break;
			case "wpa":
			$('#wifi_sec').val("WPAPSK");
			break;
			case "psk2":
			$('#wifi_sec').val("WPA2PSK");
			break;
			case "psk psk2":
			$('#wifi_sec').val("WPAPSKWPA2PSK");
			break;
		}
		switch(wpa){
			case "tkip":
			$('#TKIP_Selection').val("TKIP");
			break;
			case "aes":
			$('#TKIP_Selection').val("AES");
			break;
			case "tkip+aes":
			$('#TKIP_Selection').val("TKIPAES");
			break;
		}
		if(hide == 0 ){
			$('#wifi_visible2').attr('checked', 'checked');
		}else{
			$('#wifi_visible1').attr('checked', 'checked');
		}
		if(enbl == 0 ){
			$('#wifi_status2').attr('checked', 'checked');
		}else{
			$('#wifi_status1').attr('checked', 'checked');
		}
		if(fltmac == "allow")
			$("#ruleActive").find("input[id=mainSwitch]").prop("checked", true).change(); 
		else
		{
			$('input[name="ruleMACFilterN"]').css({'background-color' : '#E3E3E3'});
			for (var i=0;i<global_rulenum;i++){
				document.getElementById("ruleMACFilter"+i).disabled=true;
			}
		}
	}
</script>
</html>